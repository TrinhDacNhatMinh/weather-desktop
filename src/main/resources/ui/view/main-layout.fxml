<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane fx:id="mainBorderPane" styleClass="border-pane" stylesheets="@../css/main-layout-modern.css" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.nhom.weatherdesktop.ui.controller.MainLayoutController">

    <!-- SIDEBAR -->
    <left>
        <VBox fx:id="sidebar" spacing="0" styleClass="sidebar">
            <children>
                <Button fx:id="toggleSidebarButton" maxWidth="Infinity" onAction="#handleToggleSidebar" styleClass="toggle-sidebar-btn" />
                
                <Separator styleClass="sidebar-separator" />

                
                <Button fx:id="myStationButton" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleMyStations" styleClass="sidebar-button, active">
                    <graphic>
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label fx:id="myStationIcon" styleClass="sidebar-icon" />
                            <Label fx:id="myStationText" styleClass="sidebar-text" text="My Station" />
                        </HBox>
                    </graphic>
                </Button>
                        

                        
                <Button fx:id="alertsButton" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleAlerts" styleClass="sidebar-button">
                    <graphic>
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label fx:id="alertsIcon" styleClass="sidebar-icon" />
                            <Label fx:id="alertsText" styleClass="sidebar-text" text="Alerts" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="sidebarAlertBadge" styleClass="sidebar-alert-badge" text="0" visible="false" />
                        </HBox>
                    </graphic>
                </Button>
                        
                <Button fx:id="settingsButton" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleSettings" styleClass="sidebar-button">
                    <graphic>
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label fx:id="settingsIcon" styleClass="sidebar-icon" />
                            <Label fx:id="settingsText" styleClass="sidebar-text" text="Setting" />
                        </HBox>
                    </graphic>
                </Button>
                
                <!-- Spacer -->
                <Region VBox.vgrow="ALWAYS" />
                
            </children>
        </VBox>
    </left>

    <!-- CENTER CONTENT -->
    <center>
        <StackPane fx:id="contentArea" styleClass="center-content" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
            <!-- TOP BAR -->
            <VBox fx:id="topBarContainer" PickOnBounds="false" alignment="TOP_LEFT" managed="true" visible="true" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">
                <HBox alignment="CENTER_LEFT" spacing="16" styleClass="top-bar">
                    <Label fx:id="topBarTitle" styleClass="top-bar-title" text="My Station" />
                </HBox>
            </VBox>
            
            <!-- MyStation View (Default) -->
            <AnchorPane fx:id="myStationView">
                <VBox alignment="TOP_CENTER" spacing="24" styleClass="view-content" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">
                    <!-- Header with Button -->
                    <HBox alignment="CENTER_LEFT" spacing="16">
                        <Label styleClass="card-header" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="showStationsButton" onAction="#handleShowStationList" styleClass="show-stations-btn" text="Show Station List" />
                    </HBox>
                    
                    <!-- Station Info -->
                    <VBox alignment="CENTER" spacing="5" styleClass="station-info">
                        <Label fx:id="stationNameLabel" style="-fx-font-size: 28px; -fx-font-weight: bold;" styleClass="station-name" text="Select a Station" />
                        <Label fx:id="stationLocationLabel" styleClass="station-location" text="" />
                    </VBox>
                    
                    <!-- Large Temperature Display -->
                    <VBox alignment="CENTER" spacing="16" styleClass="temperature-card">
                        <HBox alignment="CENTER" spacing="24">
                            <VBox alignment="CENTER_LEFT" spacing="4">
                                <HBox alignment="BOTTOM_LEFT" spacing="8">
                                    <Label fx:id="temperatureValue" styleClass="temperature-value" text="24" />
                                    <Label styleClass="temperature-unit" text="Â°C" />
                                </HBox>
                                <Label styleClass="weather-description" text="Temperature" />
                            </VBox>
                        </HBox>
                    </VBox>
                    
                    <!-- Small Stats Grid 4x1 -->
                    <GridPane alignment="CENTER" hgap="32" maxWidth="800" styleClass="stats-grid" vgap="16">
                        <!-- Humidity -->
                        <VBox alignment="CENTER_LEFT" spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label styleClass="stat-label" text="Humidity" />
                            <HBox alignment="BOTTOM_LEFT" spacing="4">
                                <Label fx:id="humidityValue" styleClass="stat-value" text="83" />
                                <Label styleClass="stat-unit" text="\%" />
                            </HBox>
                        </VBox>
                        
                        <!-- Wind -->
                        <VBox alignment="CENTER_LEFT" spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label styleClass="stat-label" text="Wind" />
                            <HBox alignment="BOTTOM_LEFT" spacing="4">
                                <Label fx:id="windspeedValue" styleClass="stat-value" text="13" />
                                <Label styleClass="stat-unit" text="m/s" />
                            </HBox>
                        </VBox>
                        
                        <!-- Rainfall -->
                        <VBox alignment="CENTER_LEFT" spacing="4" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label styleClass="stat-label" text="Rainfall" />
                            <HBox alignment="BOTTOM_LEFT" spacing="4">
                                <Label fx:id="rainfallValue" styleClass="stat-value" text="8" />
                                <Label styleClass="stat-unit" text="mm" />
                            </HBox>
                        </VBox>
                        
                        <!-- Dust / Air Quality -->
                        <VBox alignment="CENTER_LEFT" spacing="4" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <Label styleClass="stat-label" text="Air Quality (Dust)" />
                            <HBox alignment="BOTTOM_LEFT" spacing="6">
                                <Label fx:id="dustIndicator" styleClass="stat-indicator" text="ðŸ”´" />
                                <Label fx:id="dustValue" styleClass="stat-value" text="111" />
                            </HBox>
                        </VBox>
                  <columnConstraints>
                     <ColumnConstraints />
                     <ColumnConstraints />
                     <ColumnConstraints />
                     <ColumnConstraints />
                  </columnConstraints>
                  <rowConstraints>
                     <RowConstraints />
                  </rowConstraints>
                    </GridPane>
                </VBox>
                
                <!-- Station List Panel (Initially Hidden) - Positioned on right side -->
                <VBox fx:id="stationListContainer" managed="true" spacing="12" styleClass="card,station-list-container" visible="false" AnchorPane.bottomAnchor="20.0" AnchorPane.rightAnchor="20.0" AnchorPane.topAnchor="20.0">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label styleClass="card-title,station-list-title" text="Available Stations" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button onAction="#handleShowStationList" styleClass="station-list-close-btn" text="âœ•" />
                    </HBox>
                    <Separator styleClass="station-list-separator" />
                    <ScrollPane fitToWidth="true" styleClass="station-list-scroll" VBox.vgrow="ALWAYS">
                        <VBox fx:id="stationList" spacing="12" styleClass="station-list-content">
                            <!-- Station items will be populated dynamically from API -->
                        </VBox>
                    </ScrollPane>
                    
                    <!-- Add Station Button -->
                    <Button fx:id="addStationButton" maxWidth="Infinity" onAction="#handleAddStation" styleClass="add-station-btn" text="Add Station" />
                </VBox>
            </AnchorPane>
            

            
            <!-- Alerts View (Hidden by default) -->
            <VBox fx:id="alertsView" alignment="TOP_CENTER" managed="false" spacing="24" styleClass="view-content" visible="false">
                <!-- Delete All Button - Top Right -->
                <HBox alignment="TOP_RIGHT">
                    <Button fx:id="deleteAllAlertsButton" onAction="#handleDeleteAllAlerts" styleClass="delete-all-btn" text="Delete All" visible="false" />
                </HBox>
                
                <!-- Header with unread count -->
                    <HBox alignment="CENTER_LEFT" spacing="16">
                        <Label fx:id="alertsHeaderIcon" styleClass="card-header-icon" />
                        <Label styleClass="card-header" text="Alerts" />
                        <Label fx:id="unreadCountLabel" styleClass="unread-badge" text="0" visible="false" />
                    </HBox>
                
                <!-- Alerts List Container -->
                <ScrollPane fitToWidth="true" prefHeight="600" styleClass="alerts-scroll" VBox.vgrow="ALWAYS">
                    <VBox fx:id="alertsListContainer" spacing="12" styleClass="alerts-list" />
                </ScrollPane>
                
                <!-- Empty State -->
                <VBox fx:id="emptyAlertsState" alignment="CENTER" prefHeight="400" prefWidth="500" spacing="16" styleClass="empty-state" visible="true" VBox.vgrow="ALWAYS">
                    <Label fx:id="emptyAlertsIcon" styleClass="empty-icon" />
                    <Label styleClass="empty-title" text="No alerts yet" />
                    <Label maxWidth="400" styleClass="empty-subtitle" text="You'll see notifications here when weather conditions trigger alerts" textAlignment="CENTER" wrapText="true" />
                </VBox>
            </VBox>
            
            <!-- Settings View (Hidden by default) -->
            <VBox fx:id="settingsView" alignment="TOP_CENTER" managed="false" spacing="24" styleClass="view-content" visible="false">
                <HBox alignment="CENTER_LEFT" spacing="16">
                    <Label fx:id="settingsHeaderIcon" styleClass="card-header-icon" />
                    <Label styleClass="card-header" text="Settings" />
                </HBox>
                <VBox prefWidth="500" spacing="16" styleClass="card">
                    <Label styleClass="card-title" text="Application Settings" />
                    <Separator />
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label prefWidth="120" text="Theme:" />
                        <ComboBox prefWidth="200">
                            <items>
                                <javafx.collections.FXCollections fx:factory="observableArrayList">
                                    <String fx:value="Dark" />
                                    <String fx:value="Light" />
                                </javafx.collections.FXCollections>
                            </items>
                        </ComboBox>
                    </HBox>
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label prefWidth="120" text="Temperature Unit:" />
                        <ComboBox prefWidth="200">
                            <items>
                                <javafx.collections.FXCollections fx:factory="observableArrayList">
                                    <String fx:value="Celsius (Â°C)" />
                                    <String fx:value="Fahrenheit (Â°F)" />
                                </javafx.collections.FXCollections>
                            </items>
                        </ComboBox>
                    </HBox>
                </VBox>
            </VBox>
        </StackPane>
    </center>

</BorderPane>
